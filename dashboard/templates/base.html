<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="CSTP Decision Intelligence Dashboard">
    <title>{% block title %}CSTP Dashboard{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>ğŸ§ </text></svg>">
    <script src="https://unpkg.com/htmx.org@2.0.4" integrity="sha384-HGfztofotfshcF7+8n44JQL2oJmowVChPTg48S+jvZoztPfvwD79OC/LTtG6dMp+" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.8/dist/cdn.min.js"></script>
    {% block head_scripts %}{% endblock %}
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to content</a>
    <div class="app-layout">
        <!-- Mobile Nav Toggle -->
        <button class="mobile-nav-toggle" aria-label="Toggle navigation" onclick="document.querySelector('.sidebar').classList.toggle('open');document.querySelector('.sidebar-overlay').classList.toggle('open')">â˜°</button>
        <div class="sidebar-overlay" onclick="document.querySelector('.sidebar').classList.remove('open');this.classList.remove('open')"></div>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-brand">
                <span class="sidebar-brand-icon">ğŸ§ </span>
                <div class="sidebar-brand-text">
                    <span class="sidebar-brand-name">CSTP</span>
                    <span class="sidebar-brand-sub">Decision Intelligence</span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="sidebar-section">
                    <div class="sidebar-section-label">Navigation</div>
                </div>
                <a href="{{ url_for('index') }}" class="sidebar-link {% if request.endpoint == 'index' %}active{% endif %}">
                    <span class="sidebar-link-icon">ğŸ </span>
                    Overview
                </a>
                <a href="{{ url_for('decisions') }}" class="sidebar-link {% if request.endpoint in ('decisions', 'decision_detail', 'review') %}active{% endif %}">
                    <span class="sidebar-link-icon">ğŸ“‹</span>
                    Decisions
                </a>
                <a href="{{ url_for('calibration') }}" class="sidebar-link {% if request.endpoint == 'calibration' %}active{% endif %}">
                    <span class="sidebar-link-icon">ğŸ“Š</span>
                    Calibration
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="sidebar-footer-text">CSTP v0.10</div>
            </div>
        </aside>

        <!-- Main -->
        <div class="main-content">
            {% block header %}{% endblock %}

            <div class="content" id="main-content">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="flash flash--{{ category }}">{{ message }}</div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}

                {% block content %}{% endblock %}
            </div>
        </div>
    </div>
</body>
</html>
